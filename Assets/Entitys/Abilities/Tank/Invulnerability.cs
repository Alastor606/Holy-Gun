using System.Threading.Tasks;
using UnityEngine;
using System;

[CreateAssetMenu(menuName = "Spells/Tank/Invulnerability")]
public class Invulnerability : AssetSpell
{
    [SerializeField] private float _cooldown, _doingTime;
    private bool _alive = true;
    public async override void OnTake()
    {
        while (_alive)
        {
            await Task.Delay(TimeSpan.FromSeconds(_cooldown));
            Movement.singleton.Health.CanBeDamaged = false;
            await Task.Delay(TimeSpan.FromSeconds(_doingTime));
            Movement.singleton.Health.CanBeDamaged = true;
        }
        Movement.singleton.Health.OnDie += () => _alive = false;
    }
}
